<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Type Ahead ğŸ‘€</title>
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <form class="search-form">
        <input type="text" class="search" placeholder="City or State" v-model="input">
        <!--ä½¿ç”¨v-modelæŠŠinputç¶å®šåœ¨DOMç‰©ä»¶ä¸Š;æ”¹è®Šäº†Vueå¯¦é«”dataä¸­çš„è³‡æ–™ï¼Œé é¢domä¸­çš„å€¼å°±æœƒè¢«æ”¹è®Šï¼Œåä¹‹äº¦ç„¶ï¼›åªèƒ½åœ¨è¡¨å–®å…ƒç´ æˆ–Componentsä¸Šä½¿ç”¨-->

        <ul class="suggestions">
            <!--v-showèˆ‡v-ifæ¯”è¼ƒ-->
            <!--v-showä¸èƒ½ç”¨åœ¨<template>å…ƒç´ -->
            <p v-show="show">é€™æ®µæ˜¯æ¸¬è©¦</p>
            <!--ä½¿ç”¨<template>æ¨£æ¿å…ƒç´ ä¾†ç¾¤çµ„å®ƒå€‘-->
            <template v-if="input"><!--å¦‚æœinputæ˜¯trueï¼Œæœƒå»ºç«‹å…ƒä»¶ï¼Œåœ¨<template>ä¸­çš„å…§å®¹æ‰æœƒè¢«é¡¯ç¤º;falseæ™‚å‰‡éŠ·æ¯€è©²å…ƒç´ èˆ‡ç¶å®šçš„è³‡æ–™ -->
             <li v-for="place in filterArray "><!--Arrayè¿´åœˆï¼Œv-foræœƒå°‡filterArrayé™£åˆ—ä¸€ç­†ä¸€ç­†å–å‡ºä¸¦æš«å­˜åœ¨placeè£¡ï¼Œç›´åˆ°è¿­ä»£çµæŸ-->
               
                 <span class="name" v-html="heighlight(place)"></span><!--v-htmlç”¨æ–¼æ›´æ–°ç¯€é»ç‰©ä»¶çš„innerHTMLã€‚-->
             </li>       
            </template>

            <template v-else><!--ä¸éœ€è¦è¡¨é”å¼ï¼Œinputæ˜¯falseæ™‚å°±é¡¯ç¤ºå‡ºé€™å¡Š<template>ä¸­çš„å…§å®¹-->
            <li>Filter for a city</li>

            <li>or a state</li>
            </template>
        </ul>
    </form>


    <script>
        const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

        //vue-->æ•¸æ“šé©…å‹•å…§å®¹ï¼Œå³æ‰€æœ‰çš„ä¸€åˆ‡é€šéæ“ä½œæ•¸æ“šä¾†é€²è¡Œï¼Œè€Œç›¡é‡é¿å…æ“ä½œdomæ¨¹

        //å¸¶æœ‰$-å‰ç¶´çš„å±¬æ€§èˆ‡æ–¹æ³•æ˜¯Vueå¯¦é«”ç”¨ä¾†èˆ‡Vueå¯¦é«”ä»£ç†çš„å±¬æ€§èˆ‡æ–¹æ³•(ex.data,el)åšå€åˆ¥
        let vm = new Vue({ //é¸é …(option)ç‰©ä»¶ï¼ŒåŒ…å«äº†æ‰€æœ‰vueå¯¦é«”éœ€è¦ç”¨åˆ°çš„å±¬æ€§ï¼Œéœ€è¦ç”¨åˆ°å†å¡«å¯«ä¸Šå»å°±å¯ä»¥äº†
            el: '.search-form',
            data: {
                cities: [], //åˆå§‹å€¼
                input: '', //ç©ºå­—ä¸²
                show: false, //showç‚ºfalseæ™‚ï¼ŒhtmlæœƒåŠ ä¸Šstyle ="display:none;"éš±è—è©²ç¯€é»ç‰©ä»¶çš„å…§å®¹
            },

            //vueçš„éç¨‹éšæ®µ:vueç”Ÿå‘½é€±æœŸåˆ°äº†å“ªä¸€æ­¥å°±è‡ªå‹•å»åŸ·è¡Œå°æ‡‰é‰¤å­å‡½æ•¸é‡Œé¢çš„ç¨‹å¼ç¢¼
            beforeCreate: function() { //thisæŒ‡å‘Vueå¯¦ä¾‹ç‰©ä»¶vm
                console.log("å¯¦é«”åˆå§‹åŒ–ï¼Œ$elå±¬æ€§é‚„æœªè¢«å»ºç«‹èˆ‡åˆå§‹åŒ–");
                console.dir(this); //é€™è£¡å°å‡ºä¾†çš„thiså·²ç¶“æ˜¯ mountedéšæ®µçš„thisäº†
                console.log(this.$data); //undefined
                console.log(this.$el); //undefined
                //console.log(document.querySelector(".search-form")); //é€™å€‹æ™‚å€™æ˜¯è™›æ“¬DOMç¯€é»
            },
            created: function() {
                console.log("å¯¦é«”å®Œæˆ;$dataå®Œæˆï¼Œ$elå±¬æ€§é‚„æœªè¢«å»ºç«‹èˆ‡åˆå§‹åŒ–");
                console.log(this.$data); //{__ob__: Observer}
                console.log(this.$el); //undefined
                //console.log(document.querySelector(".search-form")); //é€™å€‹æ™‚å€™æ˜¯è™›æ“¬DOMç¯€é» 
            },


            beforeMount: function() {
                console.log("æ›è¼‰ä¹‹å‰");
                console.log(this.$data); //{__ob__: Observer}
                console.log(this.$el); //<form class="search-form">...</form> //é€™å€‹æ™‚å€™æ˜¯è™›æ“¬DOMç¯€é»
                //console.log(this.$el === document.querySelector(".search-form")); //true
                //console.log(document.querySelector(".search-form")); //é€™å€‹æ™‚å€™æ˜¯è™›æ“¬DOMç¯€é»
            },


            mounted: function() { //vueå¯¦é«”å·²ç¶“æ›è¼‰åˆ°true DOMå…ƒç´ ä¸­            
                //console.log(document.querySelector(".search-form")); //é€™å€‹æ™‚å€™æ˜¯çœŸå¯¦DOMç¯€é»
                //console.log(this.$data); //{__ob__: Observer}
                //console.log(this.$el); //<form class="search-form">...</form> è™›æ“¬çš„domç¯€é»è¢«çœŸå¯¦çš„domç¯€é»å–ä»£ï¼Œä¸¦å°‡å…¶æ’å…¥åˆ°domæ¨¹ä¸­ï¼Œæ–¼æ˜¯åœ¨è§¸ç™¼mountedæ™‚ï¼Œå¯ä»¥ç²å–åˆ°$elç‚ºçœŸå¯¦çš„domå…ƒç´              ã€€ã€€
                //console.log(this.$el === document.querySelector(".search-form")); //true
                fetch(endpoint)
                    .then(response => response.json())
                    .then(data => this.cities.push(...data));
            },



            computed: { //å…·æœ‰è³‡æ–™ç·©å­˜çš„åŠŸèƒ½ï¼Œè³‡æ–™æœƒè¢«ä¿å­˜èµ·ä¾†(è¨ˆç®—çµæœ)ï¼ŒéŸ¿æ‡‰å¼ä¾è³´ç™¼ç”Ÿæ”¹è®Šæ™‚æ‰æœƒé‡æ–°æ±‚å€¼ï¼Œé‡æ–°åŸ·è¡Œå‡½å¼é‡æ–°æ¸²æŸ“ç•«é¢ï¼Œè§¸ç™¼æ™‚ä¸éœ€è¦æ¢ä»¶;ç›¸æ¯”æ¯ç•¶è§¸ç™¼é‡æ–°æ¸²æŸ“æ™‚ï¼Œèª¿ç”¨methodså°‡ç¸½æœƒå†æ¬¡åŸ·è¡Œå‡½æ•¸ï¼Œé€ æˆæ•ˆèƒ½ä½è½
                //getter
                filterArray: function() { //filterArrayéŸ¿æ‡‰å¼ä¾è³´æ–¼cities input
                    return this.cities.filter(place => { //è³‡æ–™éæ¿¾  Array[1000]

                        //Vueå¯¦é«”ä»£ç†(Proxy)äº†dataçš„æ‰€æœ‰å±¬æ€§ï¼Œå› æ­¤access this.citiesç­‰åƒ¹æ–¼ access this.$data.cities
                        //console.log(this.cities === this.$data.cities);//true

                        let regex = new RegExp(this.input, 'gi');
                        return place.city.match(regex) || place.state.match(regex)

                    })
                }
            },
            methods: { //ä¸éœ€è¦ç·©å­˜å°±ç”¨methods;èˆ‡computedé‚„æœ‰ä¸€å€‹å·®ç•°æ˜¯methodså¸¶æœ‰åƒæ•¸ï¼Œæœƒèˆ‡v-on:äº‹ä»¶ç›£è½é€£ç”¨
                heighlight: function(place) {
                    let regex = new RegExp(this.input, 'gi');
                    let cityHight = place.city.replace(regex, `<span class="h1" style="background:#ffc600">${this.input}</span>`);
                    let stateHight = place.state.replace(regex, `<span class="h1"style="background:#ffc600">${this.input}</span>`);
                    return `${cityHight},${stateHight}`
                }

            },


            beforeUpdate: function() {
                console.log("ç•¶dataè®ŠåŒ–æ™‚è¢«å‘¼å«ï¼Œé‚„ä¸æœƒæ¸²æŸ“ç•«é¢");
                console.log(this.$data); //{__ob__: Observer}
                console.log(this.$el); //<form class="search-form">...</form>

            },
            updated: function() {
                console.log("DOMæ›´æ–°å·²å®Œæˆä¸”æ¸²æŸ“ç•«é¢(å¿…é ˆç›´åˆ°é€™å€‹éšæ®µï¼Œæ‰æœƒæŠŠæœ€çµ‚çš„çµæœæ¸²æŸ“åœ¨ç€è¦½å™¨ä¸Šè¢«çœ‹åˆ°)");
                console.log(this.$data); //{__ob__: Observer}
                console.log(this.$el); //<form class="search-form">...</form>
            },

            /*beforeDestroy: function() {
                console.log("éŠ·æ¯€å‰ï¼Œå¯¦é«”é‚„å¯ä»¥ä½¿ç”¨");
                console.log(this.$data);
                console.log(this.$el);
            },
            destroyed: function() {
                console.log("å¯¦é«”å·²éŠ·æ¯€ï¼Œæ‰€æœ‰ç¶å®šè¢«è§£é™¤ï¼Œäº‹ä»¶ç›£è½è¢«ç§»é™¤ï¼Œå­å¯¦é«”ä¹Ÿè¢«éŠ·æ¯€");
                console.log(this.$data);
                console.log(this.$el);
            },*/


        });
        //console.log(vm);
    </script>
</body>

</html>